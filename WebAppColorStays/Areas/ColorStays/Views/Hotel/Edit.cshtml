@model WebAppColorStays.Models.ViewModel.CsHotel

@{
    Layout = "_Layout";
    ViewData["Action"] = "Hotel";
}

<div class="PgLtRt10 DyFx FxAnImCr Wh100p BrRs15 Ht50">
    <div class="CrTeTtLt FxGw1"> <h1>Edit @ViewBag.Title</h1></div>
    <div>
        <button class="BnCe35 HrTmSeo94 SwBx1Dv-Vn1" onclick="location.href='/ColorStays/Hotel/Create'"><i class="UT-AddFile FtSz18"></i></button>
        <button class="BnCe35 HrTmSeo94 SwBx1Dv-Vn1" onclick="location.href='/ColorStays/Hotel/Index'"><i class="UT-List-OLine FtSz18"></i></button>
    </div>
</div>

<div class="SwBx1Dv-Vn1 CrBdWe85 Pg7 BrRs15">
    <div class="FxRw FxAnImSh">
        <div class="Fx50 Pg3">
            <div id="UTabs1">
                <div> Hotel Detail</div>
                <div> Hotel Amenities</div>
                <div>Hotel Plan</div>
                <div> Hotel Image</div>
                <div>SetUp Image</div>
                <div> 360 Image</div>
                <div>SetUp 360</div>
            </div>
            <div class="BrTp3_Cr Br1_Cr BrRs10 CrBrTe CrBdTeBody Pg12">
                <div id="UTabs1Cont0">
                    <div class="Pg12">
                        <form id="Edit"
                              data-ajax="true"
                              data-ajax-url="/ColorStays/Hotel/Edit"
                              data-ajax-method="POST"
                              data-ajax-loading="#loader"
                              enctype="multipart/form-data"
                              data-ajax-success="Success(data, status, xhr,'Edit','CreateOrEdit','/ColorStays/Hotel/CreateOrEdit?id=@Model.Id')"
                              data-ajax-failure="FormAjaxFail(xhr, status, error,'Edit')">

                            @Html.AntiForgeryToken()

                            <h3 class="MnBm10"><span style="color:red">@ViewBag.Verified @ViewBag.Message</span></h3>

                            @Html.ValidationSummary(true)

                            <input type="hidden" name="NameAction" value="E" />

                            <div id="CreateOrEdit">
                                @await Html.PartialAsync("_CreateOrEdit", Model)
                            </div>
                            <div class="MnTp7 MnBm7" style="height:66vh;">
                                <div>
                                    <div class="MaxMinDv">
                                        <textarea class="TtAaTt15" placeholder="@Html.DisplayNameFor(model => model.Description)" asp-for="Description" autocomplete="off"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="MnTp7 MnBm7" style="height:66vh;">
                                <div>
                                    <div class="MaxMinDv">
                                        <textarea class="TtAaTt15" placeholder="@Html.DisplayNameFor(model => model.NearByPlace)" asp-for="NearByPlace" autocomplete="off"></textarea>
                                    </div>
                                </div>
                            </div>

                            <div class="MnTp7 MnBm7 FxRw">
                                <div class="FxGw1">
                                    <button type="submit" class="BnRd15 CrBdTeBnAd CrTtTeBnLt SwBxIt2TtBx-Vn1 HrTmSeo94"><i class="UT-EditFileLine"></i>&nbsp;Edit</button>
                                </div>
                                <div>
                                    <button type="button" class="BnRd15 CrBdTeBnCl CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94" onclick=""><i class="UT-CancelCircleLine"></i>&nbsp;Cancel</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <div id="UTabs1Cont1">
                    <div id="CreateOrEditHotel" style="height: 400px;overflow: auto;"></div>
                    <div class="Pg10 FxRw">
                        <div class="FxGw1">
                            @* <button type="button" class="BnRd15 CrBdTeBnNt CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94" onclick="location.href='/ColorStays/Hotel/Create'"><i class="UT-SmileyThumbUp FtWt800"></i>&nbsp;Finish</button> *@
                        </div>
                        <div>
                            <button type="button" class="BnRd15 CrBdTeBnPs CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94" onclick="GetHotelPlan()"><i class="UT-ArrowRightCircleLine"></i>&nbsp;Next</button>
                        </div>
                    </div>
                </div>

                <div id="UTabs1Cont2">
                    <div id="CreateOrEditPlan" style="height: 400px;overflow: auto;"></div>
                    <div class="Pg10 FxRw">
                        <div class="FxGw1">
                            @* <button type="button" class="BnRd15 CrBdTeBnNt CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94" onclick="location.href='/ColorStays/Hotel/Create'"><i class="UT-SmileyThumbUp FtWt800"></i>&nbsp;Finish</button> *@
                        </div>
                        <div>
                            <button type="button" class="BnRd15 CrBdTeBnPs CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94" onclick="ActiveTabUt('UTabs1', 3)"><i class="UT-ArrowRightCircleLine"></i>&nbsp;Next</button>
                        </div>
                    </div>
                </div>

                <div id="UTabs1Cont3">
                    <div class="Pg12">
                        <h3 class="MnTp10 MnBm18 Br2_Cr BrRs20 CrBrWe TtAnCr Pg7 HrCrTe">
                            <i class="UT-ImageLine"></i>
                            Upload Hotel Images (Size 800 X 600)
                        </h3>
                        <form action="/" enctype="multipart/form-data" method="POST">
                            <input type="hidden" name="HId" id="HId" />
                            <input type="hidden" name="HName" id="HName" />

                            <div class="dropzone" id="myDropzone">
                                <div class="fallback">
                                    <input name="file" type="file" multiple />
                                </div>
                            </div>
                            <div class="MnTp7 MnBm7 FxRw">
                                <div class="FxGw1">
                                    <button type="button" id="submit-all" class="BnRd15 CrBdTeBnAd CrTtTeBnLt SwBxIt2TtBx-Vn1 HrTmSeo94"><i class="UT-ImageLine"></i>&nbsp;Upload</button>
                                </div>
                                <div>
                                    <button style="display:none;" id="SwTb3" type="button" class="BnRd15 CrBdTeBnNt CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94 MnRt5" onclick="ActiveTabUt('UTabs1', 4)"><i class="UT-ArrowRightCircleLine"></i>&nbsp;Next</button>
                                </div>

                            </div>
                        </form>
                    </div>
                </div>

                <div id="UTabs1Cont4">
                    <div id="AddImgDetail" style="height: 400px;overflow: auto;"></div>
                    <div class="Pg10 FxRw">
                        <div class="FxGw1">
                            <button type="button" class="BnRd15 CrBdTeBnNt CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94" onclick="ActiveTabUt('UTabs1', 3)"><i class="UT-ArrowLeftCircleLine"></i>&nbsp;Back</button>
                        </div>
                        <div>
                            <button type="button" class="BnRd15 CrBdTeBnPs CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94" onclick="ActiveTabUt('UTabs1', 5)"><i class="UT-ArrowRightCircleLine"></i>&nbsp;Next</button>
                        </div>
                    </div>
                </div>

                <div id="UTabs1Cont5">
                    <div class="Pg12">
                        <h3 class="MnTp10 MnBm18 Br2_Cr BrRs20 CrBrWe TtAnCr Pg7 HrCrTe">
                            <i class="UT-ImageLine"></i>
                            Upload Hotel 360 Images (Size is not more than 3MB)
                        </h3>
                        <form action="/" enctype="multipart/form-data" method="POST">
                            <input type="hidden" name="HId" id="H3Id" />
                            <input type="hidden" name="HName" id="H3Name" />

                            <div class="dropzone" id="myDropzone1">
                                <div class="fallback">
                                    <input name="file" type="file" multiple />
                                </div>
                            </div>
                            <div class="MnTp7 MnBm7 FxRw">
                                <div class="FxGw1">
                                    <button type="button" id="submit-all1" class="BnRd15 CrBdTeBnAd CrTtTeBnLt SwBxIt2TtBx-Vn1 HrTmSeo94"><i class="UT-ImageLine"></i>&nbsp;Upload</button>
                                </div>
                                <div>
                                    <button type="button" class="BnRd15 CrBdTeBnPs CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94" onclick="ActiveTabUt('UTabs1', 4)"><i class="UT-ArrowLeftCircleLine"></i>&nbsp;Back</button>
                                    <button style="display:none;" id="SwTb4" type="button" class="BnRd15 CrBdTeBnNt CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94 MnRt5" onclick="ActiveTabUt('UTabs1', 6)"><i class="UT-ArrowRightCircleLine"></i>&nbsp;Next</button>
                                </div>

                            </div>
                        </form>
                    </div>
                </div>

                <div id="UTabs1Cont6">
                    <div id="AddImgDetail360" style="height: 400px;overflow: auto;"></div>
                    <div class="Pg10 FxRw">
                        <div class="FxGw1">
                            <button type="button" class="BnRd15 CrBdTeBnNt CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94" onclick="location.href='/ColorStays/Hotel/Create'"><i class="UT-SmileyThumbUp FtWt800"></i>&nbsp;Finish</button>
                        </div>
                        <div>
                            <button type="button" class="BnRd15 CrBdTeBnPs CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94" onclick="ActiveTabUt('UTabs1', 5)"><i class="UT-ArrowLeftCircleLine"></i>&nbsp;Back</button>
                            <button type="button" class="BnRd15 CrBdTeBnPs CrTtTeBnLt SwBxIt1Dv-Vn1 HrTmSeo94" onclick="ActiveTabUt('UTabs1', 0)"><i class="UT-CancelCircleLine"></i>&nbsp;Cancel</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <div class="Fx50 Pg3 FormSideView" id="FormSideView" style="overflow:auto">
            <div id="UTabs2">
                <div>All Hotels</div>
                <div>Hotel Facility</div>
                <div>Hotel Plan</div>
                <div>Hotel Images</div>
                <div>Hotel 360</div>
                <div onmouseup="ShowHomeHotel()">Home Package</div>
            </div>

            <div class="BrTp3_Cr Br1_Cr CrBrTe BrRs5 ">
                <div id="UTabs2Cont0">
                    <div id="Detail">
                        @await Html.PartialAsync("_IndexSearch", (IEnumerable<WebAppColorStays.Models.ViewModel.CsHotel>)ViewData["EnteredDetails"])
                    </div>
                </div>
                <div id="UTabs2Cont1">
                    <div id="Facility"></div>
                </div>
                <div id="UTabs2Cont2">
                    <div id="Plan"></div>
                </div>
                <div id="UTabs2Cont3">
                    <div id="Images"></div>
                </div>
                <div id="UTabs2Cont4">
                    <div id="360Images"></div>
                </div>
                <div id="UTabs2Cont5">
                    <div id="HomeRank2">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="~/js/tinymce_6.2.0/tinymce/js/tinymce/tinymce.min.js"></script>
<link href="~/lib/dropzone/min/dropzone.min.css" rel="stylesheet" />
<script src="~/lib/dropzone/min/dropzone.min.js"></script>

<script>
    $(document).ready(function () {
        TabsUT('UTabs1', 0, null, []);
        TabsUT('UTabs2', 0, null, []);
        IntializeTableSearch();
        StartSuggestionBox(2, 'SearchLocation', '/ColorStays/Location/SuggestLocation', '', '', AoCeLocation);
        var HotelId = $("#Id").val();
        document.getElementById('HId').value = $("#Id").val();
        document.getElementById('HName').value = $("#Name").val();
        document.getElementById('H3Id').value = $("#Id").val();
        document.getElementById('H3Name').value = $("#Name").val();
        ShowHomeHotel();
        getUT('/ColorStays/HotelImageVideo/Index?HotelId=' + HotelId, function (data) {
            document.getElementById('Images').innerHTML = "";
            document.getElementById('Images').innerHTML = data;
            document.getElementById('SwTb3').style.display = "block";
        });    
        getUT('/ColorStays/HotelImageVideo/Index360?HotelId=' + HotelId, function (data) {
            document.getElementById('360Images').innerHTML = "";
            document.getElementById('360Images').innerHTML = data;
            document.getElementById('SwTb4').style.display = "block";
        });
        //Show the Images in LHS for Update
        getUT('/ColorStays/HotelImageVideo/Index?HotelId=' + HotelId + '&UpdateDetail=Yes', function (data) {
            document.getElementById('AddImgDetail').innerHTML = "";
            document.getElementById('AddImgDetail').innerHTML = data;
        });
        // //Show the Images in LHS for Update
        getUT('/ColorStays/HotelImageVideo/Index360?HotelId=' + HotelId + '&UpdateDetail=Yes', function (data) {
            document.getElementById('AddImgDetail360').innerHTML = "";
            document.getElementById('AddImgDetail360').innerHTML = data;
        });
        getUT('/ColorStays/Hotel/HotelFacilityList?HlId=' + HotelId, function (data) {
            document.getElementById('CreateOrEditHotel').innerHTML = "";
            document.getElementById('CreateOrEditHotel').innerHTML = data;
            HideLoader();
        });
        getUT('/ColorStays/Hotel/GetHotelFacility?HlId=' + HotelId, function (data) {
            document.getElementById('Facility').innerHTML = "";
            document.getElementById('Facility').innerHTML = data;
        });
        getUT('/ColorStays/Hotel/HotelPlan?HlId=' + HotelId, function (data) {
            document.getElementById('CreateOrEditPlan').innerHTML = "";
            document.getElementById('CreateOrEditPlan').innerHTML = data;
            HideLoader();
        });
        getUT('/ColorStays/PlanType/Index?HlId=' + HotelId, function (data) {
            document.getElementById('Plan').innerHTML = "";
            document.getElementById('Plan').innerHTML = data;
        });
        if (document.getElementById('CheckInTime').value != null) {
            var InTime = document.getElementById('CheckInTime').value;
            document.getElementById('CheckInHours').value = InTime.substring(0, 2);
            document.getElementById('CheckInMinutes').value = InTime.slice(-2);
        } 
        if (document.getElementById('CheckOutTime').value != null) {
            var InTime = document.getElementById('CheckOutTime').value;
            document.getElementById('CheckOutHours').value = InTime.substring(0, 2);
            document.getElementById('CheckOutMinutes').value = InTime.slice(-2);
        }
        MaxMin();
    });


    function SetCheckInTime(data, id) {
        var CheckIn = "00:00";
        if (id == "CheckInHours") {
            CheckIn = data + ":" + document.getElementById('CheckInMinutes').value;
        }
        else {

            CheckIn = document.getElementById('CheckInHours').value + ":" + data;
        }
        document.getElementById('CheckInTime').value = CheckIn;
    }
    function SetCheckOutTime(data, id) {
        var CheckIn = "00:00";
        if (id == "CheckOutHours") {
            CheckIn = data + ":" + document.getElementById('CheckOutMinutes').value;
        }
        else {

            CheckIn = document.getElementById('CheckOutHours').value + ":" + data;
        }
        document.getElementById('CheckOutTime').value = CheckIn;
    }

    //SHow the Already uploaded images in Detail PopUp
    function HotelImage(Id) {
        getUT('/ColorStays/HotelImageVideo/Index?HotelId=' + Id + "&ShowBtn=false", function (data) {
            PopUpUpdate(data);
        });
    }
    //Ends

    tinymce.init({
        selector: '#Description, #NearByPlace',
        plugins: `a11ychecker advcode advlist advtable anchor autocorrect autosave editimage image link linkchecker lists media mediaembed pageembed powerpaste searchreplace table template tinymcespellchecker visualblocks wordcount`,
        toolbar: 'undo redo | styles | bold italic underline strikethrough | align | table link image media pageembed | bullist numlist outdent indent | spellcheckdialog a11ycheck code | Source Code',
        a11ychecker_level: 'aaa',
        style_formats: [
            { title: 'Heading 1', block: 'h1' },
            { title: 'Heading 2', block: 'h2' },
            { title: 'Paragraph', block: 'p' },
            { title: 'Blockquote', block: 'blockquote' },
            { title: 'Image formats' },
            { title: 'Medium', selector: 'img', classes: 'medium' },
        ],
        object_resizing: true,
        valid_classes: {
            'img': 'medium',
            'div': 'related-content'
        },
        image_caption: true,
        templates: [
            {
                title: 'Related content',
                description: 'This template inserts a related content block',
                content: '<div class="related-content"><h3>Related content</h3><p><strong>{$rel_lede}</strong> {$rel_body}</p></div>'
            }
        ],
        content_langs: [
            { title: 'English (US)', code: 'en_US' },
        ],
        content_style: `
                        img {
                            height: auto;
                        margin: auto;
                        padding: 10px;
                        display: block;
                                            }
                        img.medium {
                            max - width: 25%;
                                            }
                        `
    });

    //Clear Autocompete data
    function ClearData(UrNe, UrId, Text1, Text2, Text3, Text4) {
        document.getElementById(UrNe).value = '';
        document.getElementById(UrId).value = '';
        document.getElementById(Text1).value = '';
        document.getElementById(Text2).value = '';
        document.getElementById(Text3).value = '';
        document.getElementById(Text4).value = '';
    }

    //Autocomplete Item
    function AoCeLocation(event) {
        var InputId = event.target.InputID;
        SuggestionClose(InputId);
        document.getElementById('Fk_Location_Name').value = event.target.Id;
        document.getElementById(InputId).value = event.target.Value;
        document.getElementById('Fk_City_Name').value = event.target.Text2;
        document.getElementById('Fk_State_Name').value = event.target.Text3;
        document.getElementById('Fk_Country_Name').value = event.target.Text1;
        document.getElementById('Fk_Place_Name').value = event.target.Text4;
    }

    function ShowHomeHotel() {
        ShowLoader();
        getUT('/ColorStays/Hotel/Index?PageCall=ShowIxSh&Homerank=true', function (data) {
            document.getElementById("HomeRank2").innerHTML = "";
            document.getElementById("HomeRank2").innerHTML = data;
            HideLoader();
        });
    }


    function Success(data, status, xhr, FormID, FormFieldID, FormFieldURL) {
        //FormAjaxSuccess(data, FormID, FormFieldID, "UpdateDiv", "Detail");
        //Show the Image Tab
        if (data.includes("responseformUT")) {
            // case if validation error then show to user
            if (data.includes("ShowValidation")) {
                document.getElementById(FormFieldID).innerHTML = "";
                document.getElementById(FormFieldID).innerHTML = data;
                HideLoader();
            }
            else{
                document.getElementById('Detail').innerHTML = "";
                document.getElementById('Detail').innerHTML = data;
                ActiveTabUt('UTabs1', 1);
                ActiveTabUt('UTabs2', 0);
                GetHotelFacility();
                document.getElementById('HId').value = document.getElementById('HlId').value;
                document.getElementById('HName').value = document.getElementById('HlName').value;
                document.getElementById('H3Id').value = document.getElementById('HlId').value;
                document.getElementById('H3Name').value = document.getElementById('HlName').value;
            }
        }
        else {
            PopUpError(data);//Go in this Function and show the Error Message PopUp
        }
       
    }
    //Here get the list of hotel list
    function GetHotelFacility() {
        var id = $("#Id").val();
        getUT('/ColorStays/Hotel/HotelFacilityList?HlId=' + id, function (data) {
            document.getElementById('CreateOrEditHotel').innerHTML = "";
            document.getElementById('CreateOrEditHotel').innerHTML = data;
            HideLoader();
        });
    }


    function SuccessHotelFacility(data, status, xhr, FormID, FormFieldID) {
        FormAjaxSuccess(data, FormID, FormFieldID, "UpdateNothing", "Detail");
        //Show the Image Tab
        ActiveTabUt('UTabs1', 1);
        ActiveTabUt('UTabs2', 1);
        GetHotelFacility();
        GetSelectedFacility();
        document.getElementById('HlId').value = document.getElementById('HlId').value;
    }

    function GetSelectedFacility(){
        var HotelId = $("#Id").val();
        getUT('/ColorStays/Hotel/GetHotelFacility?HlId=' + HotelId, function (data) {
            document.getElementById('Facility').innerHTML = "";
            document.getElementById('Facility').innerHTML = data;
        });
    }

    //Delete Hotel Facility 
    function DeleteFacility(HlId, Id){
        getUT('/ColorStays/Hotel/DeleteFacilityOfHotel?HlId=' + HlId +'&Id='+Id, function (data) {
            GetHotelFacility();
            GetSelectedFacility();
        });
    }

    function SuccessIeDl(data, status, xhr, FormID, FormFieldID) {
        FormAjaxSuccess(data, FormID, FormFieldID, "UpdateDivNoFReset", "Images");
        ShowUploads();
        ActiveTabUt('UTabs2', 3);
    }

    function Success360Dl(data, status, xhr, FormID, FormFieldID) {
        FormAjaxSuccess(data, FormID, FormFieldID, "UpdateDivNoFReset", "360Images");
        Show360Uploads();
        ActiveTabUt('UTabs2', 4);
    }
    //Here get the list of hotel list
    function GetHotelPlan() {
        var id = $("#Id").val();
        ActiveTabUt('UTabs1', 2);
        getUT('/ColorStays/Hotel/HotelPlan?HlId=' + id, function (data) {
            document.getElementById('CreateOrEditPlan').innerHTML = "";
            document.getElementById('CreateOrEditPlan').innerHTML = data;
            HideLoader();
        });
    }

    function EditHotelPlan(id) {
        ActiveTabUt('UTabs1', 2);
        getUT('/ColorStays/Hotel/EditHotelPlan?id=' + id, function (data) {
            document.getElementById('CreateOrEditPlan').innerHTML = "";
            document.getElementById('CreateOrEditPlan').innerHTML = data;
            HideLoader();
        });
    }


    function SuccessHotelPlan(data, status, xhr, FormID, FormFieldID) {
        FormAjaxSuccess(data, FormID, FormFieldID, "UpdateDiv", "Plan");
        //Show the Image Tab
        ActiveTabUt('UTabs1', 2);
        ActiveTabUt('UTabs2', 2);
        // GetSelectedPlan();
        // var id = $("#PlanId").val();
        // if (id != "") {
        //     EditHotelPlan(id);
        // }
        document.getElementById('HlId').value = document.getElementById('HlId').value;
        HideLoader();
    }

    function GetSelectedPlan() {
        var HotelId = $("#Id").val();
        getUT('/ColorStays/PlanType/Index?HlId=' + HotelId, function (data) {
            document.getElementById('Plan').innerHTML = "";
            document.getElementById('Plan').innerHTML = data;
            HideLoader();
        });
    }

    //Delete Hotel Facility
    function DeletePlan(Id, HlId) {
        ShowLoader();
        postUT('/ColorStays/PlanType/DeleteConfirmed?id=' + Id + '&HlId=' + HlId, function (data) {
            document.getElementById('Plan').innerHTML = "";
            document.getElementById('Plan').innerHTML = data;
            HidePopUp();
            HideLoader();
        });
    }

    //Table Search Success Function
    function TableSuccessFn(data, status, xhr, FormID) {
        //This the SuccessFunction
        FormAjaxSuccess(data, FormID, '', "UpdateDivNoFReset", "Def");
        //Here we get the pageno,pagesize and listcount
        var doc = new DOMParser().parseFromString(data, "text/html");
        var pageinfo = doc.getElementById("PaginationAt");
        var netrecord = pageinfo.getAttribute("netrecord");
        var pageno = pageinfo.getAttribute("pagenumber");
        var pagesize = pageinfo.getAttribute("PageSize");
        //Refresh the Pagination Div with new Values
        RefreshPagination('/ColorStays/Hotel/Pagination?PgSelectedNum=' + pageno + '&PgSize=' + pagesize + '&SearchType=TableSearch&NetRecords=' + netrecord);
    }

    function IntializeTableSearch() {
        var SkipRow = [0, 1];
        var SkipCol = [0];
        StartTableSearch('TeUT', SkipRow, SkipCol);
    }


    //check image size and type
    document.getElementById("coverImageInput").addEventListener("change", function () {
        const file = this.files[0];

        if (!file) return;

        const maxSize = 150 * 1024; // 150KB

        if (file.type !== "image/webp") {
            alert("Only .webp images are allowed.");
            this.value = "";
            return;
        }

        if (file.size > maxSize) {
            alert("File must be less than 150KB.");
            this.value = "";
            return;
        }
    });


    Dropzone.autoDiscover = false;

    //Upload the Images

    var myDropzone = new Dropzone("#myDropzone", {
        url: '/ColorStays/Hotel/SaveImage',
        autoProcessQueue: false,
        uploadMultiple: true,
        parallelUploads: 5,
        maxFiles: 10,
        maxFilesize: 0.146, // 150KB (in MB)
        acceptedFiles: 'image/webp',
        addRemoveLinks: true,
        error: function (file, response) {
            if ($.type(response) === "string")
                var message = response; //dropzone sends it's own error messages in string
            else
                var message = response.message;
            file.previewElement.classList.add("dz-error");
            _ref = file.previewElement.querySelectorAll("[data-dz-errormessage]");
            _results = [];
            for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                node = _ref[_i];
                _results.push(node.textContent = message);
            }
            HideLoader();
            return _results;
        },
        init: function () {
             var dzClosure = this; // Makes sure that 'this' is understood inside the functions below.
            // for Dropzone to process the queue (instead of default form behavior):
            document.getElementById("submit-all").addEventListener("click", function (e) {
                // Make sure that the form isn't actually being sent.
                e.preventDefault();
                e.stopPropagation();
                dzClosure.processQueue();
            });

            //send all the form data along with the files:
            this.on("sendingmultiple", function (data, xhr, formData) {
                formData.append("HId", jQuery("#HId").val());
                formData.append("HName", jQuery("#HName").val());
                ShowLoader();
            });

            this.on("success", function () {
                ShowUploads();
            });
            // Validate file type and size manually as an extra guard
            this.on("addedfile", function (file) {
                const maxBytes = 150 * 1024; // 150KB

                // Extra check for webp MIME type and file size
                if (file.type !== "image/webp") {
                    this.removeFile(file);
                    alert("Only .webp images are allowed.");
                    return;
                }

                if (file.size > maxBytes) {
                    this.removeFile(file);
                    alert("Image must be less than 150KB.");
                }
            });
        }
    });

   
    function ShowUploads() {
        var HotelId = $("#HId").val();
        getUT('/ColorStays/HotelImageVideo/UploadedImage?HotelId=' + HotelId + '&ShowBtn=' + true, function (data) {
            document.getElementById('Images').innerHTML = "";
            document.getElementById('Images').innerHTML = data;
            ActiveTabUt('UTabs2', 3);
            document.getElementById('SwTb3').style.display = "block";
            HideLoader();
        });
        //Show the Images in LHS for Update
        getUT('/ColorStays/HotelImageVideo/Index?HotelId=' + HotelId + '&UpdateDetail=Yes', function (data) {
            document.getElementById('AddImgDetail').innerHTML = "";
            document.getElementById('AddImgDetail').innerHTML = data;
        });
    };
    //Ends.............................

    //Delete the Image
    function DeleteImg(id, HotelId, imgname) {
        ShowLoader();
        getUT('/ColorStays/HotelImageVideo/ImageDelete?ImageID=' + id + '&HotelId=' + HotelId + '&ImgName=' + imgname, function (data) {
            document.getElementById('Images').innerHTML = "";
            document.getElementById('Images').innerHTML = data;
            ActiveTabUt('UTabs2', 3);
            //Show the Images in LHS for Update
            getUT('/ColorStays/HotelImageVideo/Index?HotelId=' + HotelId + '&UpdateDetail=Yes', function (data) {
                document.getElementById('AddImgDetail').innerHTML = "";
                document.getElementById('AddImgDetail').innerHTML = data;
            });
            HideLoader();
        });

    };
    //Ends



    var myDropzone1 = new Dropzone("#myDropzone1", {
        url: '/ColorStays/Hotel/Save360Image',
        autoProcessQueue: false,
        uploadMultiple: true,
        parallelUploads: 5,
        maxFiles: 10,
        acceptedFiles: 'image/*',
        addRemoveLinks: true,
        error: function (file, response) {
            if ($.type(response) === "string")
                var message = response; //dropzone sends it's own error messages in string
            else
                var message = response.message;
            file.previewElement.classList.add("dz-error");
            _ref = file.previewElement.querySelectorAll("[data-dz-errormessage]");
            _results = [];
            for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                node = _ref[_i];
                _results.push(node.textContent = message);
            }
            HideLoader();
            return _results;
        },
        init: function () {
            var dzClosure = this; // Makes sure that 'this' is understood inside the functions below.
            // for Dropzone to process the queue (instead of default form behavior):
            document.getElementById("submit-all1").addEventListener("click", function (e) {
                // Make sure that the form isn't actually being sent.
                e.preventDefault();
                e.stopPropagation();
                dzClosure.processQueue();
            });

            //send all the form data along with the files:
            this.on("sendingmultiple", function (data, xhr, formData) {
                formData.append("HId", jQuery("#H3Id").val());
                formData.append("HName", jQuery("#H3Name").val());
                ShowLoader();
            });

            this.on("success", function () {
                Show360Uploads();
            });
        }
    });

    //Ends
    //Show the Uploaded Image in the Tab.......................
    function Show360Uploads() {
        var HotelId = $("#HId").val();
        getUT('/ColorStays/HotelImageVideo/Uploaded360?HotelId=' + HotelId + '&ShowBtn=' + true, function (data) {
            document.getElementById('360Images').innerHTML = "";
            document.getElementById('360Images').innerHTML = data;
            ActiveTabUt('UTabs2', 4);
            document.getElementById('SwTb4').style.display = "block";
            HideLoader();
        });
        //Show the Images in LHS for Update
        getUT('/ColorStays/HotelImageVideo/Index360?HotelId=' + HotelId + '&UpdateDetail=Yes', function (data) {
            document.getElementById('AddImgDetail360').innerHTML = "";
            document.getElementById('AddImgDetail360').innerHTML = data;
        });
    };
    //Ends.............................

    //Delete the Image
    function DeleteImg360(id, HotelId, imgname) {
        ShowLoader();
        getUT('/ColorStays/HotelImageVideo/Delete360?ImageID=' + id + '&HotelId=' + HotelId + '&ImgName=' + imgname, function (data) {
            document.getElementById('360Images').innerHTML = "";
            document.getElementById('360Images').innerHTML = data;
            ActiveTabUt('UTabs2', 4);
            //Show the Images in LHS for Update
            getUT('/ColorStays/HotelImageVideo/Index360?HotelId=' + HotelId + '&UpdateDetail=Yes', function (data) {
                document.getElementById('AddImgDetail360').innerHTML = "";
                document.getElementById('AddImgDetail360').innerHTML = data;
            });
            HideLoader();
        });

    };
    //Ends

</script>


